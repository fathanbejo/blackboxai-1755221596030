
<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Data Grid Siswa</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <style>
    body { font-family: 'Poppins', Arial, sans-serif; background-color: #f4f7f9; color: #333; margin: 0; padding: 20px; }
    .container { max-width: 95%; margin: 0 auto; background-color: #ffffff; padding: 25px; border-radius: 12px; box-shadow: 0 4px 20px rgba(0,0,0,0.08); }
    h2 { text-align: center; color: #1E3A8A; margin-bottom: 20px; font-weight: 600; }
    
    .toolbar { display: flex; flex-wrap: wrap; justify-content: space-between; align-items: center; gap: 15px; margin-bottom: 20px; padding-bottom: 20px; border-bottom: 1px solid #e0e0e0; }
    .filter-controls { display: flex; flex-wrap: wrap; gap: 20px; align-items: center; }
    .search-container { position: relative; }
    #searchInput { width: 250px; padding: 10px 10px 10px 35px; border: 1px solid #ccc; border-radius: 8px; font-size: 15px; }
    .search-container .fa-search { position: absolute; top: 50%; left: 12px; transform: translateY(-50%); color: #999; }
    
    .filter-group { display: flex; gap: 8px; align-items: center;}
    .filter-group label { font-weight: 500; color: #555;}
    .filter-group select { padding: 10px; border: 1px solid #ccc; border-radius: 8px; font-size: 15px; background-color: white; min-width: 150px; }
    
    .actions-container { display: flex; gap: 10px; }
    .action-button { padding: 10px 15px; background-color: #1E88E5; color: white; border: none; border-radius: 8px; font-size: 15px; font-weight: 500; cursor: pointer; transition: background-color 0.3s; display: flex; align-items: center; gap: 8px; text-decoration: none; }
    .action-button.add { background-color: #28a745; }
    .action-button.export { background-color: #00796B; }
    .action-button:hover { opacity: 0.85; }
    .action-button:disabled { background-color: #9ca3af; cursor: not-allowed; }

    .table-wrapper { width: 100%; overflow-x: auto; border: 1px solid #e0e0e0; border-radius: 8px; }
    table { width: 100%; border-collapse: collapse; }
    th, td { padding: 12px 15px; border-bottom: 1px solid #e0e0e0; text-align: left; white-space: nowrap; background-color: #fff; }
    tr:hover td { background-color: #f8f9fa; }
    
    th { background-color: #f2f4f6; font-weight: 600; position: sticky; top: 0; z-index: 2; }
    td.student-name { font-weight: 500; color: #1E3A8A; cursor: pointer; }
    td.student-name:hover { text-decoration: underline; }

    .delete-btn { color: #ef4444; cursor: pointer; background: none; border: none; font-size: 1.1em; }
    .delete-btn:hover { color: #b91c1c; }
    
    .pagination-container { display: flex; justify-content: space-between; align-items: center; margin-top: 20px; padding-top: 20px; border-top: 1px solid #e0e0e0; }
    .pagination-info { font-size: 0.9em; color: #555; }
    .pagination-controls button { margin: 0 2px; padding: 8px 12px; border: 1px solid #ccc; background-color: white; border-radius: 6px; cursor: pointer; }
    .pagination-controls button:hover:not(:disabled) { background-color: #e9ecef; }
    .pagination-controls button:disabled { cursor: not-allowed; opacity: 0.6; }
    .pagination-controls button.active { background-color: #1E88E5; color: white; border-color: #1E88E5; font-weight: bold; }
    .loading-message, .empty-message { text-align: center; padding: 40px; font-style: italic; color: #555; font-size: 1.1em; }
    .spinner { border: 4px solid #f3f3f3; border-top: 4px solid #1E88E5; border-radius: 50%; width: 24px; height: 24px; animation: spin 1s linear infinite; display: inline-block; margin-left: 8px; vertical-align: middle; }
    @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

    /* Modal Styles */
    .modal-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.6); z-index: 2000; justify-content: center; align-items: center; padding: 20px; box-sizing: border-box;}
    .modal-content { background-color: white; padding: 30px; border-radius: 12px; box-shadow: 0 5px 25px rgba(0,0,0,0.2); width: 100%; max-width: 600px; text-align: left; animation: modal-fade-in 0.3s ease-out; }
    @keyframes modal-fade-in { from { opacity: 0; transform: scale(0.9); } to { opacity: 1; transform: scale(1); } }
    .modal-title { text-align: center; color: #1E3A8A; margin-top: 0; margin-bottom: 5px; font-size: 1.5em; }
    .modal-subtitle { text-align: center; font-size: 0.9em; color: #555; margin-top: 0; margin-bottom: 20px; }
    .modal-buttons { display: flex; gap: 10px; margin-top: 20px; justify-content: flex-end;}
    #modalStudentData {
        border-top: 1px solid #eee; padding-top: 15px; margin-top: 15px;
        max-height: 60vh; overflow-y: auto;
        display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px;
    }
    .data-item { display: flex; flex-direction: column; }
    .data-item-label { font-weight: 600; font-size: 0.8em; color: #555; margin-bottom: 3px; }
    .data-item-value { font-size: 0.95em; padding: 8px; background-color: #f8f9fa; border-radius: 4px; border: 1px solid #e9ecef;}

  </style>
</head>
<body>
  <div class="container">
    <h2><i class="fas fa-table"></i> Data Grid Siswa</h2>
    <div class="toolbar">
        <div class="filter-controls">
            <div class="search-container">
                <i class="fas fa-search"></i>
                <input type="text" id="searchInput" placeholder="Cari di semua kolom...">
            </div>
            <div class="filter-group">
                <label for="presetFilter"><i class="fas fa-tags"></i> Preset:</label>
                <select id="presetFilter">
                    <option value="">-- Semua Preset --</option>
                    <option value="none">-- Tanpa Preset --</option>
                </select>
            </div>
            <div class="filter-group">
                <label for="columnFilterField"><i class="fas fa-filter"></i> Kolom:</label>
                <select id="columnFilterField">
                    <option value="">-- Pilih Kolom --</option>
                </select>
                <select id="columnFilterValue" disabled>
                    <option value="">-- Pilih Nilai --</option>
                </select>
            </div>
        </div>
        <div class="actions-container">
            <button id="exportXlsxBtn" class="action-button export"><i class="fas fa-file-excel"></i> Export XLSX</button>
            <button id="addSiswaBtn" class="action-button add"><i class="fas fa-plus-circle"></i> Tambah Siswa Baru</button>
        </div>
    </div>
    <div class="table-wrapper">
      <table id="dataTable">
        <thead id="tableHeader"></thead>
        <tbody id="tableBody">
          <tr>
            <td colspan="100%" class="loading-message">Memuat data... <span class="spinner"></span></td>
          </tr>
        </tbody>
      </table>
    </div>
    <div class="pagination-container">
      <div id="paginationInfo" class="pagination-info"></div>
      <div id="paginationControls" class="pagination-controls"></div>
    </div>
    <div class="nav-buttons-container" style="margin-top: 25px; display: flex; gap: 10px;">
        <a href="form-entri.html" class="action-button" style="justify-content: center; flex-grow: 1;"><i class="fas fa-edit"></i> Kembali ke Form Entri</a>
        <a href="form-settings.html" class="action-button" style="background-color: #64748b; justify-content: center; flex-grow: 1;"><i class="fas fa-cogs"></i> Pengaturan Form</a>
    </div>
  </div>

  <!-- Student Detail Modal -->
  <div id="studentDetailModal" class="modal-overlay">
    <div class="modal-content">
      <h3 id="modalStudentName" class="modal-title"></h3>
      <p id="modalStudentSubtitle" class="modal-subtitle"></p>
      <div id="modalStudentData">
          <!-- Data items will be injected here -->
      </div>
      <div class="modal-buttons">
          <button id="closeStudentModalBtn" class="action-button" style="background-color: #6c757d;">Tutup</button>
      </div>
    </div>
  </div>

  <script src="form-grid.js"></script>
</body>
</html>
